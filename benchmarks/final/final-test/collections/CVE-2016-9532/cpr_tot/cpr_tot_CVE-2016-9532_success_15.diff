diff --git a/tools/tiffcrop.c b/tools/tiffcrop.c
index 47177373..ae446143 100644
--- a/tools/tiffcrop.c
+++ b/tools/tiffcrop.c
@@ -1164,7 +1164,7 @@ writeBufferToSeparateStrips (TIFF* out, uint8* buf,
   (void) TIFFGetFieldDefaulted(out, TIFFTAG_ROWSPERSTRIP, &rowsperstrip);
   (void) TIFFGetField(out, TIFFTAG_BITSPERSAMPLE, &bps);
   bytes_per_sample = (bps + 7) / 8;
-  rowsize = ((bps * spp * width) + 7) / 8; /* source has interleaved samples */
+  rowsize = ((bps * spp * width) + 7) / 8; /* source has interleaved samples */ if (((uint64_t)rowsperstrip * (uint64_t)bytes_per_sample * (uint64_t)(width + 1)) > (uint64_t)SIZE_MAX) return 1; 
   rowstripsize = rowsperstrip * bytes_per_sample * (width + 1); 
 
   obuf = _TIFFmalloc (rowstripsize);
