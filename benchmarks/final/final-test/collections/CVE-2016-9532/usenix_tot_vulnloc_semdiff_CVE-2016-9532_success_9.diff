diff --git a/tools/tiffcrop.c b/tools/tiffcrop.c
index 47177373..de4c2b2e 100644
--- a/tools/tiffcrop.c
+++ b/tools/tiffcrop.c
@@ -1147,9 +1147,16 @@ static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
  */
 static int 
 writeBufferToSeparateStrips (TIFF* out, uint8* buf, 
-			     uint32 length, uint32 width, uint16 spp,
-			     struct dump_opts *dump)
+		     uint32 length, uint32 width, uint16 spp,
+		     struct dump_opts *dump)
   {
+  /* Rationale: Fix incorrect allocation size for per-sample strip buffer.
+   * The original code computed rowstripsize as rowsperstrip * bytes_per_sample * (width + 1)
+   * which is incorrect and can under-allocate (off-by-one and missing spp handling).
+   * Compute the sample row size (bytes for one sample across the width),
+   * perform integer-overflow checks, allocate accordingly, and verify that
+   * expected stripsize fits within the allocated buffer before writing.
+   */
   uint8   *src;
   uint16   bps;
   uint32   row, nrows, rowsize, rowsperstrip;
@@ -1160,12 +1167,21 @@ writeBufferToSeparateStrips (TIFF* out, uint8* buf,
   tsize_t  rowstripsize,  scanlinesize = TIFFScanlineSize(out);
   tsize_t  total_bytes = 0;
   tdata_t  obuf;
+  size_t   sample_rowsize = 0;
 
   (void) TIFFGetFieldDefaulted(out, TIFFTAG_ROWSPERSTRIP, &rowsperstrip);
   (void) TIFFGetField(out, TIFFTAG_BITSPERSAMPLE, &bps);
-  bytes_per_sample = (bps + 7) / 8;
+// FIXME: Crash CWE-787: Out-of-bounds Write
+   bytes_per_sample = (bps + 7) / 8;
   rowsize = ((bps * spp * width) + 7) / 8; /* source has interleaved samples */
-  rowstripsize = rowsperstrip * bytes_per_sample * (width + 1); 
+  /* Compute bytes per row for a single sample plane and guard against overflow */
+  sample_rowsize = ((size_t)bps * (size_t)width + 7) / 8;
+  if (rowsperstrip != 0 && sample_rowsize > SIZE_MAX / rowsperstrip)
+    {
+    /* multiplication would overflow, refuse to proceed */
+    return 1;
+    }
+  rowstripsize = (tsize_t)(rowsperstrip * (uint32)sample_rowsize);
 
   obuf = _TIFFmalloc (rowstripsize);
   if (obuf == NULL)
@@ -1178,6 +1194,12 @@ writeBufferToSeparateStrips (TIFF* out, uint8* buf,
       nrows = (row + rowsperstrip > length) ? length - row : rowsperstrip;
 
       stripsize = TIFFVStripSize(out, nrows);
+      /* Ensure we will not write beyond obuf: stripsize must fit in rowstripsize */
+      if ((tsize_t)stripsize > rowstripsize)
+        {
+        _TIFFfree(obuf);
+        return 1;
+        }
       src = buf + (row * rowsize);
       total_bytes += stripsize;
       memset (obuf, '\0', rowstripsize);
@@ -1207,6 +1229,7 @@ writeBufferToSeparateStrips (TIFF* out, uint8* buf,
   return 0;
 }
 
+
 /* Extract all planes from contiguous buffer into a single tile buffer 
  * to be written out as a tile.
  */
