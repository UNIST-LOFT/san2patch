diff --git a/tools/tiffcrop.c b/tools/tiffcrop.c
index 47177373..8e490aff 100644
--- a/tools/tiffcrop.c
+++ b/tools/tiffcrop.c
@@ -1147,8 +1147,8 @@ static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
  */
 static int 
 writeBufferToSeparateStrips (TIFF* out, uint8* buf, 
-			     uint32 length, uint32 width, uint16 spp,
-			     struct dump_opts *dump)
+		     uint32 length, uint32 width, uint16 spp,
+		     struct dump_opts *dump)
   {
   uint8   *src;
   uint16   bps;
@@ -1163,9 +1163,30 @@ writeBufferToSeparateStrips (TIFF* out, uint8* buf,
 
   (void) TIFFGetFieldDefaulted(out, TIFFTAG_ROWSPERSTRIP, &rowsperstrip);
   (void) TIFFGetField(out, TIFFTAG_BITSPERSAMPLE, &bps);
+// FIXME: Crash CWE-787: Out-of-bounds Write
+   /* Rationale: compute required buffer size in bits/bytes using 64-bit
+    * intermediates and explicit overflow checks to avoid under-allocation
+    * that leads to heap OOB writes when packing 24-bit samples.
+    */
+  if (bps == 0 || spp == 0 || width == 0 || rowsperstrip == 0)
+    return 1;
+  /* sanity limits to avoid pathological allocations */
+  if (bps > 32 || spp > 1024)
+    return 1;
   bytes_per_sample = (bps + 7) / 8;
-  rowsize = ((bps * spp * width) + 7) / 8; /* source has interleaved samples */
-  rowstripsize = rowsperstrip * bytes_per_sample * (width + 1); 
+  /* compute rowsize safely (bytes per input scanline with interleaved samples) */
+  {
+    uint64_t required_bits = (uint64_t)width * (uint64_t)spp * (uint64_t)bps;
+    uint64_t bytes_per_row = (required_bits + 7) / 8;
+    if (bytes_per_row == 0 || bytes_per_row > (uint64_t)UINT32_MAX)
+      return 1;
+    rowsize = (uint32)bytes_per_row; /* source has interleaved samples */
+
+    uint64_t required_bytes = bytes_per_row * (uint64_t)rowsperstrip;
+    if (required_bytes == 0 || required_bytes > (uint64_t)SIZE_MAX)
+      return 1;
+    rowstripsize = (tsize_t)required_bytes;
+  }
 
   obuf = _TIFFmalloc (rowstripsize);
   if (obuf == NULL)
@@ -1207,6 +1228,7 @@ writeBufferToSeparateStrips (TIFF* out, uint8* buf,
   return 0;
 }
 
+
 /* Extract all planes from contiguous buffer into a single tile buffer 
  * to be written out as a tile.
  */
