diff --git a/HTMLparser.c b/HTMLparser.c
index 69eed2bd..806f6825 100644
--- a/HTMLparser.c
+++ b/HTMLparser.c
@@ -2512,11 +2512,16 @@ htmlParseNameComplex(xmlParserCtxtPtr ctxt) {
 	}
 	len += l;
 	NEXTL(l);
-	c = CUR_CHAR(l);
-    }
+	c = CUR_CHAR(l); 
+    } if (len < 0 || ctxt->input == NULL || ((int)(ctxt->input->cur - ctxt->input->base) < len)) return NULL;
     return(xmlDictLookup(ctxt->dict, ctxt->input->cur - len, len));
 }
 
+/* Rationale: This minimal check ensures the computed 'len' is non-negative and does not
+   exceed the number of bytes available from input->base to input->cur before performing
+   the dictionary lookup. It prevents the out-of-bounds read when len is larger than the
+   buffered data. This differs from other candidates by explicitly checking len < 0 and
+   comparing against available bytes (cur - base). */
 
 /**
  * htmlParseHTMLAttribute:
