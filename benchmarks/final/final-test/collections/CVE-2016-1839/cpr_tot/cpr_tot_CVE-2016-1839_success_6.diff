diff --git a/HTMLparser.c b/HTMLparser.c
index 69eed2bd..a5a89795 100644
--- a/HTMLparser.c
+++ b/HTMLparser.c
@@ -2512,11 +2512,15 @@ htmlParseNameComplex(xmlParserCtxtPtr ctxt) {
 	}
 	len += l;
 	NEXTL(l);
-	c = CUR_CHAR(l);
-    }
+	c = CUR_CHAR(l); 
+    } if (len + l > 4096) return NULL;
     return(xmlDictLookup(ctxt->dict, ctxt->input->cur - len, len));
 }
 
+/* Rationale: Add a conservative maximum name length check (4096). This guards
+   against proceeding when the accumulated length plus the next chunk (l)
+   would exceed the allowed maximum, preventing downstream reads beyond the
+   parser buffer. This is a minimal change replacing only the <PATCH> token. */
 
 /**
  * htmlParseHTMLAttribute:
