diff --git a/HTMLparser.c b/HTMLparser.c
index 69eed2bd..1d0ed847 100644
--- a/HTMLparser.c
+++ b/HTMLparser.c
@@ -2512,8 +2512,8 @@ htmlParseNameComplex(xmlParserCtxtPtr ctxt) {
 	}
 	len += l;
 	NEXTL(l);
-	c = CUR_CHAR(l);
-    }
+	c = CUR_CHAR(l); 
+    } if ((len <= 0) || (len > (int)(ctxt->input->cur - ctxt->input->base))) return NULL; /* Rationale: Ensure the computed length 'len' does not exceed the bytes available before cur (cur - base). This prevents xmlDictLookup from reading before the buffer start or using an invalid length. */
     return(xmlDictLookup(ctxt->dict, ctxt->input->cur - len, len));
 }
 
