diff --git a/HTMLparser.c b/HTMLparser.c
index 69eed2bd..27eeaff4 100644
--- a/HTMLparser.c
+++ b/HTMLparser.c
@@ -2511,6 +2511,14 @@ htmlParseNameComplex(xmlParserCtxtPtr ctxt) {
 	    GROW;
 	}
 	len += l;
+	/* Rationale: enforce a sane maximum name/entity length to avoid
+	 * excessive buffer growth and prevent possible out-of-bounds reads
+	 * when later code assumes contiguous data. Fail fast on overly
+	 * long names instead of continuing in an unsafe state.
+	 */
+	if (len > 4096) {
+	    return(NULL);
+	}
 	NEXTL(l);
 	c = CUR_CHAR(l);
     }
