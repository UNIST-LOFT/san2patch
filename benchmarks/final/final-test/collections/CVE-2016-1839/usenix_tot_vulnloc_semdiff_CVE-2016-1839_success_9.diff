diff --git a/HTMLparser.c b/HTMLparser.c
index 69eed2bd..f2882020 100644
--- a/HTMLparser.c
+++ b/HTMLparser.c
@@ -2510,6 +2510,20 @@ htmlParseNameComplex(xmlParserCtxtPtr ctxt) {
 	    count = 0;
 	    GROW;
 	}
+	/* Rationale: Ensure there are actually enough bytes available in the input
+	 * buffer before increasing len. If the buffer does not contain the
+	 * required bytes, try to grow it (GROW). If growth didn't provide the
+	 * requested bytes, abort parsing to avoid out-of-bounds reads.
+	 */
+	if ((ctxt == NULL) || (ctxt->input == NULL) || (ctxt->input->cur == NULL) || (ctxt->input->end == NULL) ||
+	    ((size_t)(ctxt->input->end - ctxt->input->cur) <= (size_t)(len + l))) {
+	    /* try to grow once more and recheck */
+	    count = 0;
+	    GROW;
+	    if ((ctxt == NULL) || (ctxt->input == NULL) || (ctxt->input->cur == NULL) || (ctxt->input->end == NULL) ||
+		((size_t)(ctxt->input->end - ctxt->input->cur) <= (size_t)(len + l)))
+		return(NULL);
+	}
 	len += l;
 	NEXTL(l);
 	c = CUR_CHAR(l);
