diff --git a/parser.c b/parser.c
index 0d8d7f2e..347be02e 100644
--- a/parser.c
+++ b/parser.c
@@ -4074,10 +4074,16 @@ xmlParseAttValueComplex(xmlParserCtxtPtr ctxt, int *attlen, int normalize) {
     }
     if (ctxt->instate == XML_PARSER_EOF)
         goto error;
-
+// FIXME: Crash CWE-125: Out-of-bounds Read
+ 
+    /* Rationale: avoid reading buf[len-1] when len == 0 and ensure buf is valid
+     * Some parsing/backtracking paths can leave len == 0 which would underflow
+     * the index. Guard the loop with an explicit len > 0 check and ensure buf
+     * is non-NULL before writing the terminator. */
     if ((in_space) && (normalize)) {
-        while (buf[len - 1] == 0x20) len--;
+        while ((len > 0) && (buf[len - 1] == 0x20)) len--;
     }
+    if (buf == NULL) goto error;
     buf[len] = 0;
     if (RAW == '<') {
 	xmlFatalErr(ctxt, XML_ERR_LT_IN_ATTRIBUTE, NULL);
@@ -4087,6 +4093,7 @@ xmlParseAttValueComplex(xmlParserCtxtPtr ctxt, int *attlen, int normalize) {
 			   "invalid character in attribute value\n");
 	} else {
 	    xmlFatalErrMsg(ctxt, XML_ERR_ATTRIBUTE_NOT_FINISHED,
+
 			   "AttValue: ' expected\n");
         }
     } else
