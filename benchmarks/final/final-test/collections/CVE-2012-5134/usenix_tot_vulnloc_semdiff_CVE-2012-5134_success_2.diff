diff --git a/parser.c b/parser.c
index 0d8d7f2e..46925558 100644
--- a/parser.c
+++ b/parser.c
@@ -4066,17 +4066,21 @@ xmlParseAttValueComplex(xmlParserCtxtPtr ctxt, int *attlen, int normalize) {
 		if (len + 10 > buf_size) {
 		    growBuffer(buf, 10);
 		}
-	    }
-	    NEXTL(l);
-	}
-	GROW;
-	c = CUR_CHAR(l);
+    }
+    NEXTL(l);
+}
+GROW;
+c = CUR_CHAR(l);
     }
     if (ctxt->instate == XML_PARSER_EOF)
         goto error;
-
+// FIXME: Crash CWE-125: Out-of-bounds Read
+ 
+    /* Rationale: avoid reading buf[len - 1] when len == 0 which causes
+     * a one-byte out-of-bounds read (underflow). Ensure len>0 before access.
+     */
     if ((in_space) && (normalize)) {
-        while (buf[len - 1] == 0x20) len--;
+        while ((len > 0) && (buf[len - 1] == 0x20)) len--;
     }
     buf[len] = 0;
     if (RAW == '<') {
