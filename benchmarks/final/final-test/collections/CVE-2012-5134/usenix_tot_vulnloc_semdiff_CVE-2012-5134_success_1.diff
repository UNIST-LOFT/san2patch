diff --git a/parser.c b/parser.c
index 0d8d7f2e..11aab4d1 100644
--- a/parser.c
+++ b/parser.c
@@ -4074,9 +4074,14 @@ xmlParseAttValueComplex(xmlParserCtxtPtr ctxt, int *attlen, int normalize) {
     }
     if (ctxt->instate == XML_PARSER_EOF)
         goto error;
-
+// FIXME: Crash CWE-125: Out-of-bounds Read
+ 
     if ((in_space) && (normalize)) {
-        while (buf[len - 1] == 0x20) len--;
+        /* Rationale: Prevent out-of-bounds read when len == 0 by
+         * checking len before indexing buf[len - 1]. This avoids
+         * reading one byte before the buffer when len is zero.
+         */
+        while (len > 0 && buf[len - 1] == 0x20) len--;
     }
     buf[len] = 0;
     if (RAW == '<') {
