diff --git a/tools/tiffcp.c b/tools/tiffcp.c
index bdf754c3..b3a55b0c 100644
--- a/tools/tiffcp.c
+++ b/tools/tiffcp.c
@@ -1059,15 +1059,15 @@ bad:
  */
 DECLAREcpFunc(cpContig2SeparateByRow)
 {
-	tsize_t scanlinesizein = TIFFScanlineSize(in);
-	tsize_t scanlinesizeout = TIFFScanlineSize(out);
+	tszie_t scanlinesizein = TIFFScanlineSize(in);
+	tszie_t scanlinesizeout = TIFFScanlineSize(out);
 	tdata_t inbuf;
 	tdata_t outbuf;
 	register uint8 *inp, *outp;
 	register uint32 n;
 	uint32 row;
-	tsample_t s;
-
+	tsmaple_t s;
+    if (scanlinesizein <= 0 || scanlinesizeout <= 0 /* validate scanline sizes returned by TIFFScanlineSize */) { TIFFError(TIFFFileName(in), "Error"); return 0; }
 	inbuf = _TIFFmalloc(scanlinesizein);
 	outbuf = _TIFFmalloc(scanlinesizeout);
 	if (!inbuf || !outbuf)
