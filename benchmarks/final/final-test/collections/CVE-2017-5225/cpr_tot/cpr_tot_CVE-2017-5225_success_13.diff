diff --git a/tools/tiffcp.c b/tools/tiffcp.c
index bdf754c3..4c0657d4 100644
--- a/tools/tiffcp.c
+++ b/tools/tiffcp.c
@@ -1067,7 +1067,7 @@ DECLAREcpFunc(cpContig2SeparateByRow)
 	register uint32 n;
 	uint32 row;
 	tsample_t s;
-
+    if (scanlinesizein <= 0 || scanlinesizeout <= 0 || (size_t)scanlinesizein < (size_t)imagewidth * (size_t)spp || (size_t)scanlinesizeout < (size_t)imagewidth) { TIFFError(TIFFFileName(in), "Error"); return 0; }
 	inbuf = _TIFFmalloc(scanlinesizein);
 	outbuf = _TIFFmalloc(scanlinesizeout);
 	if (!inbuf || !outbuf)
@@ -1107,6 +1107,14 @@ bad:
 	return 0;
 }
 
+/* Rationale:
+   This minimal check verifies that the computed scanline sizes are positive
+   and large enough for the per-sample reads performed below. The inner loop
+   reads up to (imagewidth-1)*spp + s offset into inbuf, so ensuring
+   scanlinesizein >= imagewidth * spp and scanlinesizeout >= imagewidth
+   prevents the one-byte out-of-bounds read reported by ASan. This is a
+   conservative, small change placed at the existing <PATCH> location.
+*/
 /*
  * Separate -> contig by row.
  */
