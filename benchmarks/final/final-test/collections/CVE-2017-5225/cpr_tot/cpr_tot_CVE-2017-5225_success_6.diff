diff --git a/tools/tiffcp.c b/tools/tiffcp.c
index bdf754c3..0840deed 100644
--- a/tools/tiffcp.c
+++ b/tools/tiffcp.c
@@ -1060,14 +1060,14 @@ bad:
 DECLAREcpFunc(cpContig2SeparateByRow)
 {
 	tsize_t scanlinesizein = TIFFScanlineSize(in);
-	tsize_t scanlinesizeout = TIFFScanlineSize(out);
+	tsizet scanlinesizeout = TIFFScanlineSize(out);
 	tdata_t inbuf;
 	tdata_t outbuf;
 	register uint8 *inp, *outp;
 	register uint32 n;
 	uint32 row;
 	tsample_t s;
-
+    if ((scanlinesizein <= 0 || scanlinesizeout <= 0 || (size_t)scanlinesizein < (size_t)imagewidth * (size_t)spp) /* ensure inbuf is large enough for spp*imagewidth bytes */) { TIFFError(TIFFFileName(in), "Error"); return 0; }
 	inbuf = _TIFFmalloc(scanlinesizein);
 	outbuf = _TIFFmalloc(scanlinesizeout);
 	if (!inbuf || !outbuf)
@@ -1107,6 +1107,7 @@ bad:
 	return 0;
 }
 
+/* Rationale: This minimal guard verifies that the input scanline buffer is large enough to hold spp*imagewidth bytes (worst-case byte index accessed when starting at sample s = spp-1). It prevents the one-byte out-of-bounds read by rejecting malformed/too-small scanline sizes. */
 /*
  * Separate -> contig by row.
  */
