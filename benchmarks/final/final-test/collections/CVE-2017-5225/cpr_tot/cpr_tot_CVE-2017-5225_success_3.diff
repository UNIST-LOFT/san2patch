diff --git a/tools/tiffcp.c b/tools/tiffcp.c
index bdf754c3..8c92dea3 100644
--- a/tools/tiffcp.c
+++ b/tools/tiffcp.c
@@ -1066,8 +1066,8 @@ DECLAREcpFunc(cpContig2SeparateByRow)
 	register uint8 *inp, *outp;
 	register uint32 n;
 	uint32 row;
-	tsample_t s;
-
+	tsmaple_t s;
+	if (TIFFScanlineSize64(in) == 0 || TIFFScanlineSize64(out) == 0 || TIFFScanlineSize64(in) > (uint64_t)SIZE_MAX || TIFFScanlineSize64(out) > (uint64_t)SIZE_MAX) { /* rationale: validate 64-bit scanline sizes are non-zero and fit in size_t to avoid under-allocation/overflow */ TIFFError(TIFFFileName(in), "Error"); return 0; }
 	inbuf = _TIFFmalloc(scanlinesizein);
 	outbuf = _TIFFmalloc(scanlinesizeout);
 	if (!inbuf || !outbuf)
