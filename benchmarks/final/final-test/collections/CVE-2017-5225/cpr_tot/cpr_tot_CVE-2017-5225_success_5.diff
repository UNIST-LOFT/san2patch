diff --git a/tools/tiffcp.c b/tools/tiffcp.c
index bdf754c3..97c46312 100644
--- a/tools/tiffcp.c
+++ b/tools/tiffcp.c
@@ -1067,7 +1067,7 @@ DECLAREcpFunc(cpContig2SeparateByRow)
 	register uint32 n;
 	uint32 row;
 	tsample_t s;
-
+    if (scanlinesizein <= 0 || scanlinesizeout <= 0 || (size_t)imagewidth * (size_t)spp > (size_t)scanlinesizein || (size_t)imagewidth > (size_t)scanlinesizeout) { TIFFError(TIFFFileName(in), "Error"); return 0; } /* Rationale: ensure the allocated scanline buffers are large enough for the de-interleaving: inbuf must be >= imagewidth*spp and outbuf must be >= imagewidth. This prevents the later reads/writes from going out-of-bounds. */
 	inbuf = _TIFFmalloc(scanlinesizein);
 	outbuf = _TIFFmalloc(scanlinesizeout);
 	if (!inbuf || !outbuf)
