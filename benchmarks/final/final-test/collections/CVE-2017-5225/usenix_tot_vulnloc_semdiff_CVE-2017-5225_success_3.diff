diff --git a/tools/tiffcp.c b/tools/tiffcp.c
index bdf754c3..f7b5b0e0 100644
--- a/tools/tiffcp.c
+++ b/tools/tiffcp.c
@@ -1065,6 +1065,22 @@ DECLAREcpFunc(cpContig2SeparateByRow)
 	tdata_t outbuf;
 	register uint8 *inp, *outp;
 	register uint32 n;
+	/* Rationale: If the scanline sizes reported are smaller than the amount of
+	   data actually accessed, enlarge the requested allocation to the minimum
+	   safe size. This avoids under-sized allocations while keeping changes
+	   minimal. Overflow checks are performed before resizing. */
+	{
+		size_t need_in;
+		/* guard multiplications for overflow */
+		if (imagewidth != 0 && (size_t)spp > ((size_t)-1) / (size_t)imagewidth)
+			goto bad;
+		need_in = (size_t)imagewidth * (size_t)spp;
+		if ((size_t)scanlinesizein < need_in)
+			scanlinesizein = (tsize_t)need_in;
+		if ((size_t)scanlinesizeout < (size_t)imagewidth)
+			scanlinesizeout = (tsize_t)imagewidth;
+	}
+
 	uint32 row;
 	tsample_t s;
 
