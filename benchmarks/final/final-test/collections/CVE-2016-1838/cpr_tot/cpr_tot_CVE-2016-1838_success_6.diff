diff --git a/parser.c b/parser.c
index 68e1c90f..aaf608d8 100644
--- a/parser.c
+++ b/parser.c
@@ -9832,8 +9832,8 @@ xmlParseEndTag2(xmlParserCtxtPtr ctxt, const xmlChar *prefix,
 	return;
     }
     SKIP(2);
-
-    if ((tlen > 0) && (xmlStrncmp(ctxt->input->cur, ctxt->name, tlen) == 0)) {
+ 
+    if ((tlen > 0) && ((size_t)(ctxt->input->end - ctxt->input->cur) > (size_t)tlen) && (xmlStrncmp(ctxt->input->cur, ctxt->name, tlen) == 0)) {
         if (ctxt->input->cur[tlen] == '>') {
 	    ctxt->input->cur += tlen + 1;
 	    ctxt->input->col += tlen + 1;
@@ -9890,6 +9890,14 @@ done:
     return;
 }
 
+/* Rationale:
+   Minimal guard added: require that the available bytes in the input
+   buffer are strictly greater than tlen (i.e. at least tlen+1 bytes).
+   This ensures xmlStrncmp has the required tlen bytes available and also
+   that the subsequent access to ctxt->input->cur[tlen] (to check for
+   '>') is in-bounds. This is a small, local change that prevents the
+   out-of-bounds read while preserving normal parsing behavior for
+   well-formed input. */
 /**
  * xmlParseCDSect:
  * @ctxt:  an XML parser context
