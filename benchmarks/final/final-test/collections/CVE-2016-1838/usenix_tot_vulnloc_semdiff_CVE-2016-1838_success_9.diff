diff --git a/parser.c b/parser.c
index 68e1c90f..5b4c6339 100644
--- a/parser.c
+++ b/parser.c
@@ -9831,17 +9831,34 @@ xmlParseEndTag2(xmlParserCtxtPtr ctxt, const xmlChar *prefix,
 	xmlFatalErr(ctxt, XML_ERR_LTSLASH_REQUIRED, NULL);
 	return;
     }
-    SKIP(2);
+/* Rationale: Ensure we have at least two characters remaining before SKIP(2)
+   to avoid advancing ctxt->input->cur past ctxt->input->end on truncated input. */
+    if ((ctxt->input == NULL) || (ctxt->input->cur == NULL) || (ctxt->input->end == NULL) ||
+        ((ctxt->input->end - ctxt->input->cur) < 2)) {
+        xmlFatalErr(ctxt, XML_ERR_GT_REQUIRED, NULL);
+        return;
+    }
+     SKIP(2);
 
-    if ((tlen > 0) && (xmlStrncmp(ctxt->input->cur, ctxt->name, tlen) == 0)) {
-        if (ctxt->input->cur[tlen] == '>') {
+    if ((tlen > 0) && (/* ensure enough bytes for comparison */
+        ((ctxt->input != NULL) && (ctxt->input->cur != NULL) && (ctxt->input->end != NULL) &&
+         ((ctxt->input->end - ctxt->input->cur) >= tlen)) &&
+        (xmlStrncmp(ctxt->input->cur, ctxt->name, tlen) == 0))) {
+        /* ensure we can safely inspect cur[tlen] */
+        if ((ctxt->input->end - ctxt->input->cur) >= (tlen + 1) && (ctxt->input->cur[tlen] == '>')) {
 	    ctxt->input->cur += tlen + 1;
 	    ctxt->input->col += tlen + 1;
 	    goto done;
 	}
-	ctxt->input->cur += tlen;
-	ctxt->input->col += tlen;
-	name = (xmlChar*)1;
+        if ((ctxt->input->end - ctxt->input->cur) >= tlen) {
+	    ctxt->input->cur += tlen;
+	    ctxt->input->col += tlen;
+	    name = (xmlChar*)1;
+	} else {
+	    /* truncated: not enough data for the tag name */
+	    xmlFatalErr(ctxt, XML_ERR_GT_REQUIRED, NULL);
+	    return;
+	}
     } else {
 	if (prefix == NULL)
 	    name = xmlParseNameAndCompare(ctxt, ctxt->name);
@@ -9872,8 +9889,8 @@ xmlParseEndTag2(xmlParserCtxtPtr ctxt, const xmlChar *prefix,
         if ((line == 0) && (ctxt->node != NULL))
             line = ctxt->node->line;
         xmlFatalErrMsgStrIntStr(ctxt, XML_ERR_TAG_NAME_MISMATCH,
-		     "Opening and ending tag mismatch: %s line %d and %s\n",
-		                ctxt->name, line, name);
+	     "Opening and ending tag mismatch: %s line %d and %s\n",
+	                ctxt->name, line, name);
     }
 
     /*
@@ -9890,6 +9907,7 @@ done:
     return;
 }
 
+
 /**
  * xmlParseCDSect:
  * @ctxt:  an XML parser context
