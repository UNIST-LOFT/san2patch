diff --git a/parser.c b/parser.c
index 68e1c90f..bfcf823b 100644
--- a/parser.c
+++ b/parser.c
@@ -9831,10 +9831,21 @@ xmlParseEndTag2(xmlParserCtxtPtr ctxt, const xmlChar *prefix,
 	xmlFatalErr(ctxt, XML_ERR_LTSLASH_REQUIRED, NULL);
 	return;
     }
-    SKIP(2);
+// Rationale: Ensure we have at least some input before attempting any comparisons or indexing
+// This prevents reading past the buffer when input is truncated.
+     SKIP(2);
+
+    if (ctxt->input->cur >= ctxt->input->end) {
+        /* truncated input */
+        xmlFatalErr(ctxt, XML_ERR_TAG_NOT_FINISHED, NULL);
+        return;
+    }
 
-    if ((tlen > 0) && (xmlStrncmp(ctxt->input->cur, ctxt->name, tlen) == 0)) {
-        if (ctxt->input->cur[tlen] == '>') {
+    /* Ensure there are at least 'tlen' bytes available for xmlStrncmp and
+     * at least 'tlen+1' bytes available before indexing ctxt->input->cur[tlen]
+     */
+    if ((tlen > 0) && ((ctxt->input->end - ctxt->input->cur) >= (ptrdiff_t)tlen) && (xmlStrncmp(ctxt->input->cur, ctxt->name, tlen) == 0)) {
+        if (((ctxt->input->end - ctxt->input->cur) >= (ptrdiff_t)(tlen + 1)) && (ctxt->input->cur[tlen] == '>')) {
 	    ctxt->input->cur += tlen + 1;
 	    ctxt->input->col += tlen + 1;
 	    goto done;
@@ -9890,6 +9901,7 @@ done:
     return;
 }
 
+
 /**
  * xmlParseCDSect:
  * @ctxt:  an XML parser context
