diff --git a/libtiff/tif_jpeg.c b/libtiff/tif_jpeg.c
index 38595f98..198e8527 100644
--- a/libtiff/tif_jpeg.c
+++ b/libtiff/tif_jpeg.c
@@ -1683,29 +1683,44 @@ JPEGSetupEncode(TIFF* tif)
 #ifdef JPEG_LIB_MK1
         sp->cinfo.c.bits_in_jsample = td->td_bitspersample;
 #endif
-	if (isTiled(tif)) {
+		if (isTiled(tif)) {
+		/* Rationale: Validate sampling factors to avoid division/modulo by zero when
+		   computing DCT-based denominators (sp->v_sampling * DCTSIZE,
+		   sp->h_sampling * DCTSIZE). If invalid (zero or negative), return an
+		   error instead of performing arithmetic that could raise SIGFPE. */
+		if (sp->v_sampling <= 0) {
+			TIFFErrorExt(tif->tif_clientdata, module,
+			      "Invalid vertical sampling factor %d", sp->v_sampling);
+			return (0);
+		}
+		if (sp->h_sampling <= 0) {
+			TIFFErrorExt(tif->tif_clientdata, module,
+			      "Invalid horizontal sampling factor %d", sp->h_sampling);
+			return (0);
+		}
 		if ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {
 			TIFFErrorExt(tif->tif_clientdata, module,
-				  "JPEG tile height must be multiple of %d",
-				  sp->v_sampling * DCTSIZE);
+			      "JPEG tile height must be multiple of %d",
+			      sp->v_sampling * DCTSIZE);
 			return (0);
 		}
 		if ((td->td_tilewidth % (sp->h_sampling * DCTSIZE)) != 0) {
 			TIFFErrorExt(tif->tif_clientdata, module,
-				  "JPEG tile width must be multiple of %d",
-				  sp->h_sampling * DCTSIZE);
+			      "JPEG tile width must be multiple of %d",
+			      sp->h_sampling * DCTSIZE);
 			return (0);
 		}
 	} else {
 		if (td->td_rowsperstrip < td->td_imagelength &&
 		    (td->td_rowsperstrip % (sp->v_sampling * DCTSIZE)) != 0) {
 			TIFFErrorExt(tif->tif_clientdata, module,
-				  "RowsPerStrip must be multiple of %d for JPEG",
-				  sp->v_sampling * DCTSIZE);
+			      "RowsPerStrip must be multiple of %d for JPEG",
+			      sp->v_sampling * DCTSIZE);
 			return (0);
 		}
 	}
 
+
 	/* Create a JPEGTables field if appropriate */
 	if (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {
                 if( sp->jpegtables == NULL
