diff --git a/libtiff/tif_jpeg.c b/libtiff/tif_jpeg.c
index 38595f98..da34f924 100644
--- a/libtiff/tif_jpeg.c
+++ b/libtiff/tif_jpeg.c
@@ -1681,20 +1681,44 @@ JPEGSetupEncode(TIFF* tif)
 	}
 	sp->cinfo.c.data_precision = td->td_bitspersample;
 #ifdef JPEG_LIB_MK1
-        sp->cinfo.c.bits_in_jsample = td->td_bitspersample;
+// FIXME: Crash CWE-369: Divide By Zero
+         sp->cinfo.c.bits_in_jsample = td->td_bitspersample;
 #endif
+	/* Rationale: Validate sampling factors and tile dimensions that will be
+	 * used as divisors in subsequent arithmetic (modulo). If any of these
+	 * values are zero or non-positive, fail the setup to avoid SIGFPE.
+	 */
+	if (sp->v_sampling <= 0) {
+		TIFFErrorExt(tif->tif_clientdata, module,
+			  "Invalid vertical sampling factor %d", sp->v_sampling);
+		return (0);
+	}
+	if (sp->h_sampling <= 0) {
+		TIFFErrorExt(tif->tif_clientdata, module,
+			  "Invalid horizontal sampling factor %d", sp->h_sampling);
+		return (0);
+	}
+	if (td->td_tilelength <= 0) {
+		TIFFErrorExt(tif->tif_clientdata, module,
+			  "Invalid tile length %d", td->td_tilelength);
+		return (0);
+	}
+	if (td->td_tilewidth <= 0) {
+		TIFFErrorExt(tif->tif_clientdata, module,
+			  "Invalid tile width %d", td->td_tilewidth);
+		return (0);
+	}
 	if (isTiled(tif)) {
 		if ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {
 			TIFFErrorExt(tif->tif_clientdata, module,
-				  "JPEG tile height must be multiple of %d",
-				  sp->v_sampling * DCTSIZE);
+			      "JPEG tile height must be multiple of %d",
+			      sp->v_sampling * DCTSIZE);
 			return (0);
 		}
 		if ((td->td_tilewidth % (sp->h_sampling * DCTSIZE)) != 0) {
 			TIFFErrorExt(tif->tif_clientdata, module,
-				  "JPEG tile width must be multiple of %d",
-				  sp->h_sampling * DCTSIZE);
-			return (0);
+			      "JPEG tile width must be multiple of %d",
+			      sp->h_sampling * DCTSIZE);			return (0);
 		}
 	} else {
 		if (td->td_rowsperstrip < td->td_imagelength &&
