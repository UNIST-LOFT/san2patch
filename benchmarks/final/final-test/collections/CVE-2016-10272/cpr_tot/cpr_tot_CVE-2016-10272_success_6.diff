diff --git a/libtiff/tif_dumpmode.c b/libtiff/tif_dumpmode.c
index d01295d4..891cc0d1 100644
--- a/libtiff/tif_dumpmode.c
+++ b/libtiff/tif_dumpmode.c
@@ -98,14 +98,24 @@ DumpModeDecode(TIFF* tif, uint8* buf, tmsize_t cc, uint16 s)
 	/*
 	 * Avoid copy if client has setup raw
 	 * data buffer to avoid extra copy.
-	 */
-	if (tif->tif_rawcp != buf)
+// FIXME: Crash CWE-787: Out-of-bounds Write
+ 	 */
+	/* Guard: Do not copy more than the configured scanline size. */
+	if (tif->tif_rawcp != buf) {
+		if (cc > TIFFScanlineSize(tif)) {
+			TIFFErrorExt(tif->tif_clientdata, module,
+			"Refusing to copy %lld bytes, exceeds scanline size %lld",
+			 (signed long long)cc, (signed long long)TIFFScanlineSize(tif));
+			return (0);
+		}
 		_TIFFmemcpy(buf, tif->tif_rawcp, cc);
+	}
 	tif->tif_rawcp += cc;
 	tif->tif_rawcc -= cc;  
 	return (1);
 }
 
+
 /*
  * Seek forwards nrows in the current strip.
  */
