diff --git a/libtiff/tif_read.c b/libtiff/tif_read.c
index 52bbf507..3ea56b2d 100644
--- a/libtiff/tif_read.c
+++ b/libtiff/tif_read.c
@@ -375,14 +375,29 @@ TIFFReadEncodedStrip(TIFF* tif, uint32 strip, void* buf, tmsize_t size)
 
 	if ((size!=(tmsize_t)(-1))&&(size<stripsize))
 		stripsize=size;
-	if (!TIFFFillStrip(tif,strip))
+// FIXME: Crash CWE-787: Out-of-bounds Write
+ 	if (!TIFFFillStrip(tif,strip))
 		return((tmsize_t)(-1));
-	if ((*tif->tif_decodestrip)(tif,buf,stripsize,plane)<=0)
-		return((tmsize_t)(-1));
-	(*tif->tif_postdecode)(tif,buf,stripsize);
-	return(stripsize);
+	{
+		/* Call decoder into a temporary count and validate it */
+		tmsize_t cc;
+		cc = (*tif->tif_decodestrip)(tif,buf,stripsize,plane);
+		if (cc<=0)
+			return((tmsize_t)(-1));
+		/* Defensive: decoder must not return more bytes than the
+		   provided buffer can hold. Reject if it does. */
+		if (cc > stripsize) {
+			TIFFErrorExt(tif->tif_clientdata, module,
+			    "Decoder returned %ld bytes which exceeds buffer size %ld",
+			    (long)cc, (long)stripsize);
+			return((tmsize_t)(-1));
+		}
+		(*tif->tif_postdecode)(tif,buf,cc);
+		return(cc);
+	}
 }
 
+
 static tmsize_t
 TIFFReadRawStrip1(TIFF* tif, uint32 strip, void* buf, tmsize_t size,
     const char* module)
diff --git a/tools/tiffcrop.c b/tools/tiffcrop.c
index b87a77a8..24d9f0ca 100644
--- a/tools/tiffcrop.c
+++ b/tools/tiffcrop.c
@@ -6120,7 +6120,11 @@ loadImage(TIFF* in, struct image_data *image, struct dump_opts *dump, unsigned c
     if( buffsize > 0xFFFFFFFFU - 3 )
     {
         TIFFError("loadImage", "Unable to allocate/reallocate read buffer");
-        return (-1);
+        if (buffsize + 3 <= buffsize) {
+            TIFFError("loadImage", "Unable to allocate/reallocate read buffer");
+            return (-1);
+        }
+         return (-1);
     }
     read_buff = (unsigned char *)_TIFFmalloc(buffsize+3);
   }
