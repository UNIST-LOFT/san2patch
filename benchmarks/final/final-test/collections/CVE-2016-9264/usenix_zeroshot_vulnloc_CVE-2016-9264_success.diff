diff --git a/util/listmp3.c b/util/listmp3.c
index b7f06190..115dde2e 100644
--- a/util/listmp3.c
+++ b/util/listmp3.c
@@ -123,30 +123,58 @@ void printMP3Headers(FILE *f)
 
     bitrateSum += bitrate;
 
-    if(version == 1)
+// FIXME: Crash
+     if(version == 1)
     {
+      /* Rationale: samplerate_idx and bitrate_idx may be out of range and cause
+         a global-buffer-overflow when indexing the static tables. Validate
+         indices against the actual table sizes before using them. If an index
+         is invalid, abort through error() to avoid undefined behavior. */
+      size_t _sr_count = sizeof(mp1_samplerate_table)/sizeof(mp1_samplerate_table[0]);
+      if(samplerate_idx >= _sr_count) error("unknown MP3 samplerate index!");
       samplerate = mp1_samplerate_table[samplerate_idx];
 
-      if(layer == 1)
+      if(layer == 1) {
+	size_t _br_count = sizeof(mp1l1_bitrate_table)/sizeof(mp1l1_bitrate_table[0]);
+	if(bitrate_idx >= _br_count) error("unknown MP3 bitrate index!");
 	bitrate = mp1l1_bitrate_table[bitrate_idx];
+      }
 
-      else if(layer == 2)
+      else if(layer == 2) {
+	size_t _br_count = sizeof(mp1l2_bitrate_table)/sizeof(mp1l2_bitrate_table[0]);
+	if(bitrate_idx >= _br_count) error("unknown MP3 bitrate index!");
 	bitrate = mp1l2_bitrate_table[bitrate_idx];
+      }
 
-      else if(layer == 3)
+      else if(layer == 3) {
+	size_t _br_count = sizeof(mp1l3_bitrate_table)/sizeof(mp1l3_bitrate_table[0]);
+	if(bitrate_idx >= _br_count) error("unknown MP3 bitrate index!");
 	bitrate = mp1l3_bitrate_table[bitrate_idx];
+      }
     }
     else
     {
-      if(version == 2)
+      if(version == 2) {
+        size_t _sr_count = sizeof(mp2_samplerate_table)/sizeof(mp2_samplerate_table[0]);
+        if(samplerate_idx >= _sr_count) error("unknown MP3 samplerate index!");
 	samplerate = mp2_samplerate_table[samplerate_idx];
-      else
+      }
+      else {
+        size_t _sr_count = sizeof(mp25_samplerate_table)/sizeof(mp25_samplerate_table[0]);
+        if(samplerate_idx >= _sr_count) error("unknown MP3 samplerate index!");
 	samplerate = mp25_samplerate_table[samplerate_idx];
+      }
 
-      if(layer == 1)
+      if(layer == 1) {
+	size_t _br_count = sizeof(mp2l1_bitrate_table)/sizeof(mp2l1_bitrate_table[0]);
+	if(bitrate_idx >= _br_count) error("unknown MP3 bitrate index!");
 	bitrate = mp2l1_bitrate_table[bitrate_idx];
-      else
+      }
+      else {
+	size_t _br_count = sizeof(mp2l23_bitrate_table)/sizeof(mp2l23_bitrate_table[0]);
+	if(bitrate_idx >= _br_count) error("unknown MP3 bitrate index!");
 	bitrate = mp2l23_bitrate_table[bitrate_idx];
+      }
     }
 
     padding = (flags & MP3_PADDING) ? 1 : 0;
