diff --git a/util/listmp3.c b/util/listmp3.c
index b7f06190..1b6452d8 100644
--- a/util/listmp3.c
+++ b/util/listmp3.c
@@ -101,7 +101,7 @@ void printMP3Headers(FILE *f)
 
     ++numFrames;
 
-    bitrate_idx = (flags & MP3_BITRATE) >> MP3_BITRATE_SHIFT;
+    bitrate_idx = (flags & MP3_BITRATE) >> MP3_BITRATE_SHIFT; 
     samplerate_idx = (flags & MP3_SAMPLERATE) >> MP3_SAMPLERATE_SHIFT;
 
     channels = ((flags & MP3_CHANNEL) == MP3_CHANNEL_MONO) ? 1 : 2;
@@ -121,7 +121,7 @@ void printMP3Headers(FILE *f)
       default: error("unknown MP3 layer!");
     }
 
-    bitrateSum += bitrate;
+    if (version==1 && (unsigned)samplerate_idx >= (sizeof(mp1_samplerate_table) / sizeof(mp1_samplerate_table[0]))) error("invalid samplerate index"); bitrateSum += bitrate;
 
     if(version == 1)
     {
@@ -176,6 +176,8 @@ void printMP3Headers(FILE *f)
   printf("Length: %i:%02i\n", length/60, length%60);
 }
 
+Rationale: This minimal change adds an explicit bounds check for the mp1_samplerate_table immediately where the original code would have errored. It uses sizeof to compute the table length and only triggers the error for version==1 MP3 frames, preventing any out-of-bounds read of mp1_samplerate_table without changing other logic. This is different from other variants because it uses an unsigned comparison with sizeof(...)/sizeof(...).
+
 int main(int argc, char *argv[])
 {
   FILE *f;
