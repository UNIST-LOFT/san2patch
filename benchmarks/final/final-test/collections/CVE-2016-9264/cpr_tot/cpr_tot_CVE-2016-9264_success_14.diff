diff --git a/util/listmp3.c b/util/listmp3.c
index b7f06190..46eefe0c 100644
--- a/util/listmp3.c
+++ b/util/listmp3.c
@@ -101,7 +101,7 @@ void printMP3Headers(FILE *f)
 
     ++numFrames;
 
-    bitrate_idx = (flags & MP3_BITRATE) >> MP3_BITRATE_SHIFT;
+    bitrate_idx = (flags & MP3_BITRATE) >> MP3_BITRATE_SHIFT; 
     samplerate_idx = (flags & MP3_SAMPLERATE) >> MP3_SAMPLERATE_SHIFT;
 
     channels = ((flags & MP3_CHANNEL) == MP3_CHANNEL_MONO) ? 1 : 2;
@@ -121,6 +121,16 @@ void printMP3Headers(FILE *f)
       default: error("unknown MP3 layer!");
     }
 
+    {
+      /* validate samplerate_idx against proper table sizes to avoid OOB */
+      size_t mp1_sr_count = sizeof(mp1_samplerate_table) / sizeof(mp1_samplerate_table[0]);
+      size_t mp2_sr_count = sizeof(mp2_samplerate_table) / sizeof(mp2_samplerate_table[0]);
+      size_t mp25_sr_count = sizeof(mp25_samplerate_table) / sizeof(mp25_samplerate_table[0]);
+      if ((version==1 && (unsigned)samplerate_idx >= mp1_sr_count) ||
+	  (version==2 && (unsigned)samplerate_idx >= mp2_sr_count) ||
+	  (version==25 && (unsigned)samplerate_idx >= mp25_sr_count))
+	error("invalid samplerate index");
+    }
     bitrateSum += bitrate;
 
     if(version == 1)
