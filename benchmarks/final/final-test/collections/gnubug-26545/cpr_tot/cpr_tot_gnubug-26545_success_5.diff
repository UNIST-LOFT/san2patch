diff --git a/gnulib b/gnulib
--- a/gnulib
+++ b/gnulib
@@ -1 +1 @@
-Subproject commit 405cd675384221b541b460c43de26d159914fe0a
+Subproject commit 405cd675384221b541b460c43de26d159914fe0a-dirty
diff --git a/src/shred.c b/src/shred.c
index a317c4439..762da4509 100644
--- a/src/shred.c
+++ b/src/shred.c
@@ -286,8 +286,8 @@ fillpattern (int type, unsigned char *r, size_t size)
   bits |= bits << 12;
   r[0] = (bits >> 4) & 255;
   r[1] = (bits >> 8) & 255;
-  r[2] = bits & 255;
-  for (i = 3; i < size / 2; i *= 2)
+  r[2] = bits & 255; 
+  for (i = 3; i < (size / 2) + 1; i *= 2)
     memcpy (r + i, r, i);
   if (i < size)
     memcpy (r + i, r, size - i);
@@ -298,6 +298,15 @@ fillpattern (int type, unsigned char *r, size_t size)
       r[i] ^= 0x80;
 }
 
+/* Rationale:
+   Replaced the loop upper bound with (size / 2) + 1 so the loop only performs
+   doubling copies while 2*i <= size. This guarantees that each memcpy(r + i, r, i)
+   writes at most up to r + 2*i which stays within the allocated buffer, and
+   ensures the final remainder copy (size - i) is <= i (no overlap where dest
+   starts before src+len). This avoids overlapping memcpy ranges and thus
+   undefined behavior. This candidate is different from the other candidates by
+   using the explicit expression (size / 2) + 1 as the loop limit.
+*/
 /*
  * Generate a 6-character (+ nul) pass name string
  * FIXME: allow translation of "random".
