diff --git a/libtiff/tif_dirwrite.c b/libtiff/tif_dirwrite.c
index c9e871be..b8d4badf 100644
--- a/libtiff/tif_dirwrite.c
+++ b/libtiff/tif_dirwrite.c
@@ -970,8 +970,8 @@ TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* di
 		case SAMPLEFORMAT_INT:
 			if (tif->tif_dir.td_bitspersample<=8)
 			{
-				for (i = 0; i < count; ++i)
-					((int8*)conv)[i] = (int8)value[i];
+				for (i = 0; i < count; ++i) 
+					((int8*)conv)[i] = (value[i] >= -128.0 && value[i] <= 127.0 ? (int8)value[i] : (TIFFErrorExt(tif->tif_clientdata, module, "SampleFormat value %g out of range for SBYTE", value[i]), ok=0, (int8)0)); /* Rationale: check range and report out-of-range values to avoid silent truncation; on error assign 0 as safe fallback */
 				ok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);
 			}
 			else if (tif->tif_dir.td_bitspersample<=16)
