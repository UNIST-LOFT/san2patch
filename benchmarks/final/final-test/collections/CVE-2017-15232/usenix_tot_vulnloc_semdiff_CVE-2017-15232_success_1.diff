diff --git a/jdpostct.c b/jdpostct.c
index 601fc2a7..aa5b2247 100644
--- a/jdpostct.c
+++ b/jdpostct.c
@@ -128,10 +128,25 @@ post_process_1pass (j_decompress_ptr cinfo,
                     JDIMENSION in_row_groups_avail,
                     JSAMPARRAY output_buf, JDIMENSION *out_row_ctr,
                     JDIMENSION out_rows_avail)
-{
-  my_post_ptr post = (my_post_ptr) cinfo->post;
+// FIXME: Crash CWE-476: NULL Pointer Dereference
+ {
   JDIMENSION num_rows, max_rows;
 
+  /* Defensive checks to avoid NULL-pointer dereference (CWE-476).
+   * Minimal checks are performed and function returns early when
+   * required pointers or counters are not available. This prevents
+   * dereferencing post, post->buffer, or other members below.
+   */
+  if (cinfo == NULL || in_row_group_ctr == NULL || out_row_ctr == NULL)
+    return;
+  my_post_ptr post = (my_post_ptr) cinfo->post;
+  if (post == NULL || post->buffer == NULL || output_buf == NULL)
+    return;
+  if (cinfo->upsample == NULL || cinfo->upsample->upsample == NULL)
+    return;
+  if (cinfo->cquantize == NULL || cinfo->cquantize->color_quantize == NULL)
+    return;
+
   /* Fill the buffer, but not more than what we can dump out in one go. */
   /* Note we rely on the upsampler to detect bottom of image. */
   max_rows = out_rows_avail - *out_row_ctr;
@@ -148,6 +163,7 @@ post_process_1pass (j_decompress_ptr cinfo,
 }
 
 
+
 #ifdef QUANT_2PASS_SUPPORTED
 
 /*
