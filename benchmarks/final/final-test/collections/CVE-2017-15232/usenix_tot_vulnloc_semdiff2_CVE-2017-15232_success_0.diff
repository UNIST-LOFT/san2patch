diff --git a/jquant1.c b/jquant1.c
index e7814815..f5d78499 100644
--- a/jquant1.c
+++ b/jquant1.c
@@ -528,18 +528,36 @@ quantize_ord_dither (j_decompress_ptr cinfo, JSAMPARRAY input_buf,
   int nc = cinfo->out_color_components;
   int ci;
   int row;
-  JDIMENSION col;
+// Rationale: Add defensive checks to avoid NULL dereferences when quantizer
+// tables or buffers were not initialized (allocation failure or malformed input).
+// If essential resources are missing, bail out early to prevent crashes.
+   JDIMENSION col;
   JDIMENSION width = cinfo->output_width;
 
+  /* Defensive early exit: ensure required structures are present */
+  if (cquantize == NULL || input_buf == NULL || output_buf == NULL || nc <= 0 || width == 0) {
+    return;
+  }
+
   for (row = 0; row < num_rows; row++) {
     /* Initialize output values to 0 so can process components separately */
     jzero_far((void *) output_buf[row], (size_t) (width * sizeof(JSAMPLE)));
     row_index = cquantize->row_index;
     for (ci = 0; ci < nc; ci++) {
+      /* Verify per-component tables exist before using them */
+      if (cquantize->colorindex == NULL || cquantize->odither == NULL)
+        continue;
+
       input_ptr = input_buf[row] + ci;
       output_ptr = output_buf[row];
       colorindex_ci = cquantize->colorindex[ci];
+      if (colorindex_ci == NULL)
+        continue;
+      if (cquantize->odither[ci] == NULL)
+        continue;
       dither = cquantize->odither[ci][row_index];
+      if (dither == NULL)
+        continue;
       col_index = 0;
 
       for (col = width; col > 0; col--) {
@@ -563,6 +581,7 @@ quantize_ord_dither (j_decompress_ptr cinfo, JSAMPARRAY input_buf,
 }
 
 
+
 METHODDEF(void)
 quantize3_ord_dither (j_decompress_ptr cinfo, JSAMPARRAY input_buf,
                       JSAMPARRAY output_buf, int num_rows)
