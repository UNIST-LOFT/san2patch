diff --git a/jquant1.c b/jquant1.c
index e7814815..e0ae0ce9 100644
--- a/jquant1.c
+++ b/jquant1.c
@@ -529,9 +529,9 @@ quantize_ord_dither (j_decompress_ptr cinfo, JSAMPARRAY input_buf,
   int ci;
   int row;
   JDIMENSION col;
-  JDIMENSION width = cinfo->output_width;
+  JDIMENSION width = cinfo->output_width; 
 
-  for (row = 0; row < num_rows; row++) {
+  if (cquantize == NULL || cquantize->colorindex == NULL || cquantize->odither == NULL) ERREXIT(cinfo, JERR_BAD_STATE); for (row = 0; row < num_rows; row++) {
     /* Initialize output values to 0 so can process components separately */
     jzero_far((void *) output_buf[row], (size_t) (width * sizeof(JSAMPLE)));
     row_index = cquantize->row_index;
@@ -562,6 +562,7 @@ quantize_ord_dither (j_decompress_ptr cinfo, JSAMPARRAY input_buf,
   }
 }
 
+Rationale: This minimal change adds a NULL-check for the primary per-image quantization state (cquantize) and its key tables (colorindex and odither) before any dereference occurs. If any of these are NULL the function invokes the library error path, preventing the NULL dereference in subsequent code. This candidate differs from others by validating the internal cquantize tables specifically.
 
 METHODDEF(void)
 quantize3_ord_dither (j_decompress_ptr cinfo, JSAMPARRAY input_buf,
