diff --git a/jquant1.c b/jquant1.c
index e7814815..d79de308 100644
--- a/jquant1.c
+++ b/jquant1.c
@@ -528,9 +528,19 @@ quantize_ord_dither (j_decompress_ptr cinfo, JSAMPARRAY input_buf,
   int nc = cinfo->out_color_components;
   int ci;
   int row;
-  JDIMENSION col;
+// FIXME: Crash CWE-476: NULL Pointer Dereference
+   JDIMENSION col;
   JDIMENSION width = cinfo->output_width;
 
+  /* Minimal defensive checks: ensure the top-level pointers the function
+   * relies on are present. This avoids NULL dereferences while keeping
+   * changes minimal. If these checks fail, abort decompression with a
+   * clear error rather than crashing.
+   */
+  if (input_buf == NULL || output_buf == NULL || cquantize == NULL) {
+    ERREXIT(cinfo, JERR_OUT_OF_MEMORY);
+  }
+
   for (row = 0; row < num_rows; row++) {
     /* Initialize output values to 0 so can process components separately */
     jzero_far((void *) output_buf[row], (size_t) (width * sizeof(JSAMPLE)));
@@ -550,6 +560,12 @@ quantize_ord_dither (j_decompress_ptr cinfo, JSAMPARRAY input_buf,
          * inputs.  The maximum dither is +- MAXJSAMPLE; this sets the
          * required amount of padding.
          */
+        /* Additional defensive check just before dereference to avoid
+         * a crash if an unexpectedly NULL pointer is encountered.
+         */
+        if (colorindex_ci == NULL || dither == NULL) {
+          ERREXIT(cinfo, JERR_OUT_OF_MEMORY);
+        }
         *output_ptr += colorindex_ci[GETJSAMPLE(*input_ptr)+dither[col_index]];
         input_ptr += nc;
         output_ptr++;
@@ -563,6 +579,7 @@ quantize_ord_dither (j_decompress_ptr cinfo, JSAMPARRAY input_buf,
 }
 
 
+
 METHODDEF(void)
 quantize3_ord_dither (j_decompress_ptr cinfo, JSAMPARRAY input_buf,
                       JSAMPARRAY output_buf, int num_rows)
