diff --git a/jquant1.c b/jquant1.c
index e7814815..8dfc3489 100644
--- a/jquant1.c
+++ b/jquant1.c
@@ -528,9 +528,19 @@ quantize_ord_dither (j_decompress_ptr cinfo, JSAMPARRAY input_buf,
   int nc = cinfo->out_color_components;
   int ci;
   int row;
-  JDIMENSION col;
+// FIXME: Crash CWE-476: NULL Pointer Dereference
+   JDIMENSION col;
   JDIMENSION width = cinfo->output_width;
 
+  /* Rationale: defend against NULL quantizer or buffers on exceptional
+   * paths (e.g. read-and-discard). If necessary resources are NULL,
+   * avoid dereferencing them by returning early. This preserves normal
+   * behavior when properly initialized but prevents SIGSEGV on skip
+   * or discard paths.
+   */
+  if (cquantize == NULL || input_buf == NULL || output_buf == NULL)
+    return;
+
   for (row = 0; row < num_rows; row++) {
     /* Initialize output values to 0 so can process components separately */
     jzero_far((void *) output_buf[row], (size_t) (width * sizeof(JSAMPLE)));
@@ -563,6 +573,7 @@ quantize_ord_dither (j_decompress_ptr cinfo, JSAMPARRAY input_buf,
 }
 
 
+
 METHODDEF(void)
 quantize3_ord_dither (j_decompress_ptr cinfo, JSAMPARRAY input_buf,
                       JSAMPARRAY output_buf, int num_rows)
