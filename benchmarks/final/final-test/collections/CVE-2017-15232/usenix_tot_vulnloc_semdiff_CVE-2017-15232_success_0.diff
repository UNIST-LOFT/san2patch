diff --git a/jdpostct.c b/jdpostct.c
index 601fc2a7..2674ac81 100644
--- a/jdpostct.c
+++ b/jdpostct.c
@@ -128,10 +128,26 @@ post_process_1pass (j_decompress_ptr cinfo,
                     JDIMENSION in_row_groups_avail,
                     JSAMPARRAY output_buf, JDIMENSION *out_row_ctr,
                     JDIMENSION out_rows_avail)
-{
+// FIXME: Crash CWE-476: NULL Pointer Dereference
+ {
   my_post_ptr post = (my_post_ptr) cinfo->post;
   JDIMENSION num_rows, max_rows;
 
+  /* Rationale: defensive NULL checks added to ensure that required
+     per-decompression state (post, buffers, upsampler and quantizer)
+     are present before they are dereferenced. If any required pointer
+     is NULL, invoke the library error handler and abort the operation
+     to avoid a NULL pointer dereference. */
+  if (post == NULL || post->buffer == NULL ||
+      cinfo->upsample == NULL || cinfo->upsample->upsample == NULL ||
+      cinfo->cquantize == NULL || cinfo->cquantize->color_quantize == NULL ||
+      input_buf == NULL || output_buf == NULL ||
+      cinfo->err == NULL || cinfo->err->error_exit == NULL) {
+    if (cinfo != NULL && cinfo->err != NULL && cinfo->err->error_exit != NULL)
+      (*cinfo->err->error_exit) (cinfo);
+    return; /* error_exit normally does not return, but keep return for analyzers */
+  }
+
   /* Fill the buffer, but not more than what we can dump out in one go. */
   /* Note we rely on the upsampler to detect bottom of image. */
   max_rows = out_rows_avail - *out_row_ctr;
@@ -148,6 +164,7 @@ post_process_1pass (j_decompress_ptr cinfo,
 }
 
 
+
 #ifdef QUANT_2PASS_SUPPORTED
 
 /*
