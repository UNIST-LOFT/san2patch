diff --git a/tools/tiff2ps.c b/tools/tiff2ps.c
index ae296e91..89d0dae1 100644
--- a/tools/tiff2ps.c
+++ b/tools/tiff2ps.c
@@ -2437,8 +2437,18 @@ PSDataColorContig(FILE* fd, TIFF* tif, uint32 w, uint32 h, int nc)
 	int breaklen = MAXLINE, es = samplesperpixel - nc;
 	tsize_t cc;
 	unsigned char *tf_buf;
-	unsigned char *cp, c;
-
+	unsigned char *cp, c; 
+ if ({/* Verify that the TIFF-provided scanline size is valid and at least as large as the currently configured tf_bytesperrow. This prevents reading past a too-small allocation. */ 
+		tsize_t scanline = TIFFScanlineSize(tif);
+		if (scanline <= 0) {
+			TIFFError(filename, "Invalid scanline size");
+			return;
+		}
+		if ((size_t)scanline > tf_bytesperrow) {
+			TIFFError(filename, "Configured tf_bytesperrow is smaller than TIFF scanline size");
+			return;
+		}
+	} return;
 	(void) w;
 	tf_buf = (unsigned char *) _TIFFmalloc(tf_bytesperrow);
 	if (tf_buf == NULL) {
@@ -2492,7 +2502,6 @@ PSDataColorContig(FILE* fd, TIFF* tif, uint32 w, uint32 h, int nc)
 	}
 	_TIFFfree((char *) tf_buf);
 }
-
 void
 PSDataColorSeparate(FILE* fd, TIFF* tif, uint32 w, uint32 h, int nc)
 {
