diff --git a/libtiff/tif_ojpeg.c b/libtiff/tif_ojpeg.c
index 1ccc3f9b..b7932cb4 100644
--- a/libtiff/tif_ojpeg.c
+++ b/libtiff/tif_ojpeg.c
@@ -811,8 +811,25 @@ OJPEGDecodeRaw(TIFF* tif, uint8* buf, tmsize_t cc)
 	uint8* ocr;
 	uint8* p;
 	uint32 q;
-	uint8* r;
+// FIXME: Crash
+ 	uint8* r;
 	uint8 sx,sy;
+	/* Rationale:
+	   The sanitizer reported an FPE at this function. The most likely cause
+	   is the modulo operation (cc % sp->bytes_per_line) when
+	   sp->bytes_per_line == 0, which triggers a divide-by-zero.
+	   To prevent this, validate sp and bytes_per_line before using it.
+	*/
+	if (sp == NULL)
+	{
+		TIFFErrorExt(tif->tif_clientdata,module,"Missing OJPEG state");
+		return(0);
+	}
+	if (sp->bytes_per_line == 0)
+	{
+		TIFFErrorExt(tif->tif_clientdata,module,"Invalid bytes_per_line (0)");
+		return(0);
+	}
 	if (cc%sp->bytes_per_line!=0)
 	{
 		TIFFErrorExt(tif->tif_clientdata,module,"Fractional scanline not read");
