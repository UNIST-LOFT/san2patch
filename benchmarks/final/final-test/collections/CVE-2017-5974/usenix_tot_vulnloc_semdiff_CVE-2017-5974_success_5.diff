diff --git a/zzip/memdisk.c b/zzip/memdisk.c
index 007e7ce..32e6528 100644
--- a/zzip/memdisk.c
+++ b/zzip/memdisk.c
@@ -192,14 +192,32 @@ zzip_mem_entry_new(ZZIP_DISK * disk, ZZIP_DISK_ENTRY * entry)
     {   /* copy the extra blocks to memory as well (maximum 64K each) */
         zzip_size_t /*    */ ext1_len = zzip_disk_entry_get_extras(entry);
         char *_zzip_restrict ext1_ptr = zzip_disk_entry_to_extras(entry);
-        zzip_size_t /*    */ ext2_len = zzip_file_header_get_extras(header);
+// FIXME: Crash CWE-125: Out-of-bounds Read
+         zzip_size_t /*    */ ext2_len = zzip_file_header_get_extras(header);
         char *_zzip_restrict ext2_ptr = zzip_file_header_to_extras(header);
 
-        if (ext1_ptr + ext1_len >= disk->endbuf ||
-            ext2_ptr + ext2_len >= disk->endbuf)
+        /* Rationale: Use safe remaining-byte checks instead of pointer+len
+         * arithmetic to avoid pointer-wrap and out-of-bounds reads.
+         * Compute remaining bytes from ext pointer to disk->endbuf and
+         * ensure extN_len fits into that space. If not, treat as format error.
+         */
         {
-            errno = EBADMSG; /* format error CVE-2017-5978 */
-            goto error; /* zzip_mem_entry_free(item); return 0; */
+            size_t rem1 = 0, rem2 = 0;
+            if (ext1_len) {
+                if (!ext1_ptr) { errno = EBADMSG; goto error; }
+                if (ext1_ptr >= disk->endbuf) { errno = EBADMSG; goto error; }
+                rem1 = (size_t)(disk->endbuf - ext1_ptr);
+            }
+            if (ext2_len) {
+                if (!ext2_ptr) { errno = EBADMSG; goto error; }
+                if (ext2_ptr >= disk->endbuf) { errno = EBADMSG; goto error; }
+                rem2 = (size_t)(disk->endbuf - ext2_ptr);
+            }
+            if ((ext1_len && ext1_len > rem1) || (ext2_len && ext2_len > rem2))
+            {
+                errno = EBADMSG; /* format error CVE-2017-5978 */
+                goto error; /* zzip_mem_entry_free(item); return 0; */
+            }
         }
 
         if (ext1_len)
@@ -243,6 +261,7 @@ error:
     ____;
 }
 
+
 /* find an extra block for the given datatype code.
  * The returned EXTRA_BLOCK is still in disk-encoding but
  * already a pointer into an allocated heap space block.
