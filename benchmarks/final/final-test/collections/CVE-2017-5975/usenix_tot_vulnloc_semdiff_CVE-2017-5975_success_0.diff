diff --git a/zzip/memdisk.c b/zzip/memdisk.c
index 007e7ce..c8b73a3 100644
--- a/zzip/memdisk.c
+++ b/zzip/memdisk.c
@@ -176,7 +176,14 @@ zzip_mem_entry_new(ZZIP_DISK * disk, ZZIP_DISK_ENTRY * entry)
     /*  there is a number of duplicated information in the file header
      *  or the disk entry block. Theoretically some part may be missing
      *  that exists in the other, ... but we will prefer the disk entry.
+// FIXME: Crash CWE-476: NULL Pointer Dereference
+      */
+    /* Rationale: header may be NULL if earlier lookup/mapping failed.
+     * Avoid dereferencing header below by validating it and returning
+     * an error (cleanup via goto error) to prevent CWE-476.
      */
+    if (!header) { errno = EBADMSG; goto error; }
+
     item->zz_comment = zzip_disk_entry_strdup_comment(disk, entry);
     item->zz_name = zzip_disk_entry_strdup_name(disk, entry);
     item->zz_data = zzip_file_header_to_data(header);
@@ -243,6 +250,7 @@ error:
     ____;
 }
 
+
 /* find an extra block for the given datatype code.
  * The returned EXTRA_BLOCK is still in disk-encoding but
  * already a pointer into an allocated heap space block.
