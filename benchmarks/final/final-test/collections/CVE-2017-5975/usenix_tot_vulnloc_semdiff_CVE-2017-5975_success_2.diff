diff --git a/zzip/memdisk.c b/zzip/memdisk.c
index 007e7ce..d1a3dc5 100644
--- a/zzip/memdisk.c
+++ b/zzip/memdisk.c
@@ -176,7 +176,17 @@ zzip_mem_entry_new(ZZIP_DISK * disk, ZZIP_DISK_ENTRY * entry)
     /*  there is a number of duplicated information in the file header
      *  or the disk entry block. Theoretically some part may be missing
      *  that exists in the other, ... but we will prefer the disk entry.
+// FIXME: Crash CWE-476: NULL Pointer Dereference
+      */
+    /* Validate header pointer before any dereference. If header is NULL
+     * or lies outside the mapped disk buffer, fail early to avoid
+     * NULL/near-NULL dereferences (fix CWE-476/CWE-754).
      */
+    if (! header || (char*)header < (char*)disk->base || (char*)header >= (char*)disk->endbuf)
+    {
+        errno = EBADMSG; /* format error */
+        goto error;
+    }
     item->zz_comment = zzip_disk_entry_strdup_comment(disk, entry);
     item->zz_name = zzip_disk_entry_strdup_name(disk, entry);
     item->zz_data = zzip_file_header_to_data(header);
