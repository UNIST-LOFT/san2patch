From fc4817064f81ef9a82b1b1468b1b8a4ae352c1f2 Mon Sep 17 00:00:00 2001
From: Daniel-Constantin Mierla <miconda@gmail.com>
Date: Fri, 11 Oct 2024 11:41:02 +0200
Subject: [PATCH] core: parser sdp - check for length of sendrecv attribute

---
 src/core/parser/sdp/sdp_helpr_funcs.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/src/core/parser/sdp/sdp_helpr_funcs.c b/src/core/parser/sdp/sdp_helpr_funcs.c
index a5dffd9c39..a5186fb442 100644
--- a/src/core/parser/sdp/sdp_helpr_funcs.c
+++ b/src/core/parser/sdp/sdp_helpr_funcs.c
@@ -447,6 +447,9 @@ int extract_sendrecv_mode(str *body, str *sendrecv_mode, int *is_on_hold)
 {
 	char *cp1;
 
+	if(body->len < 10) {
+		return -1;
+	}
 	cp1 = body->s;
 	if(!((strncasecmp(cp1, "a=sendrecv", 10) == 0)
 			   || (strncasecmp(cp1, "a=recvonly", 10) == 0))) {
-- 
2.17.1

