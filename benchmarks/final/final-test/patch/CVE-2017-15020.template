 180 | static bfd_boolean
 181 | parse_die (bfd *             abfd,
 182 | 	   struct die_info * aDieInfo,
 183 | 	   bfd_byte *        aDiePtr,
 184 | 	   bfd_byte *        aDiePtrEnd)
 185 | {
 186 |   bfd_byte *this_die = aDiePtr;
 187 |   bfd_byte *xptr = this_die;
 188 | 
 189 |   memset (aDieInfo, 0, sizeof (* aDieInfo));
 190 | 
 191 |   /* First comes the length.  */
 192 |   aDieInfo->length = bfd_get_32 (abfd, (bfd_byte *) xptr);
 193 |   xptr += 4;
 194 |   if (aDieInfo->length == 0
 195 |       || (this_die + aDieInfo->length) >= aDiePtrEnd)
 196 |     return FALSE;
 197 |   if (aDieInfo->length < 6)
 198 |     {
 199 |       /* Just padding bytes.  */
 200 |       aDieInfo->tag = TAG_padding;
 201 |       return TRUE;
 202 |     }
 203 | 
 204 |   /* Then the tag.  */
 205 |   aDieInfo->tag = bfd_get_16 (abfd, (bfd_byte *) xptr);
 206 |   xptr += 2;
 207 | 
 208 |   /* Then the attributes.  */
 209 |   while (xptr < (this_die + aDieInfo->length))
 210 |     {
 211 |       unsigned short attr;
 212 | 
 213 |       /* Parse the attribute based on its form.  This section
 214 |          must handle all dwarf1 forms, but need only handle the
 215 | 	 actual attributes that we care about.  */
 216 |       attr = bfd_get_16 (abfd, (bfd_byte *) xptr);
 217 |       xptr += 2;
 218 | 
 219 |       switch (FORM_FROM_ATTR (attr))
 220 | 	{
 221 | 	case FORM_DATA2:
 222 | 	  xptr += 2;
 223 | 	  break;
 224 | 	case FORM_DATA4:
 225 | 	case FORM_REF:
 226 | 	  if (attr == AT_sibling)
 227 | 	    aDieInfo->sibling = bfd_get_32 (abfd, (bfd_byte *) xptr);
 228 | 	  else if (attr == AT_stmt_list)
 229 | 	    {
 230 | 	      aDieInfo->stmt_list_offset = bfd_get_32 (abfd, (bfd_byte *) xptr);
 231 | 	      aDieInfo->has_stmt_list = 1;
 232 | 	    }
 233 | 	  xptr += 4;
 234 | 	  break;
 235 | 	case FORM_DATA8:
 236 | 	  xptr += 8;
 237 | 	  break;
 238 | 	case FORM_ADDR:
 239 | 	  if (attr == AT_low_pc)
 240 | 	    aDieInfo->low_pc = bfd_get_32 (abfd, (bfd_byte *) xptr);
 241 | 	  else if (attr == AT_high_pc)
 242 | 	    aDieInfo->high_pc = bfd_get_32 (abfd, (bfd_byte *) xptr);
 243 | 	  xptr += 4;
 244 | 	  break;
 245 | 	case FORM_BLOCK2:
 246 | 	  xptr += 2 + bfd_get_16 (abfd, (bfd_byte *) xptr);
 247 | 	  break;
 248 | 	case FORM_BLOCK4:
 249 | 	  xptr += 4 + bfd_get_32 (abfd, (bfd_byte *) xptr);
 250 | 	  break;
 251 | 	case FORM_STRING:
 252 | 	  if (attr == AT_name)
 253 | 	    aDieInfo->name = (char *) xptr; // PATCH LOCATION
 254 | 	  xptr += <PATCH> + 1;
 255 | 	  break;
 256 | 	}
 257 |     }
 258 | 
 259 |   return TRUE;
 260 | }
