From d10257fbfdbb3e3e73c0fe60a224585822bdd7b3 Mon Sep 17 00:00:00 2001
From: Daniel-Constantin Mierla <miconda@gmail.com>
Date: Fri, 25 Oct 2024 20:45:59 +0200
Subject: [PATCH] core: parser sdp - check len gor extracting fmtp

---
 src/core/parser/sdp/sdp_helpr_funcs.c | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/src/core/parser/sdp/sdp_helpr_funcs.c b/src/core/parser/sdp/sdp_helpr_funcs.c
index fe5b464e47..0e61fe5ca5 100644
--- a/src/core/parser/sdp/sdp_helpr_funcs.c
+++ b/src/core/parser/sdp/sdp_helpr_funcs.c
@@ -218,8 +218,12 @@ int extract_fmtp(str *body, str *fmtp_payload, str *fmtp_string)
 	char *cp, *cp1;
 	int len;
 
+	if(body->len <= 7) {
+		return -1;
+	}
 	if(strncasecmp(body->s, "a=fmtp:", 7) != 0) {
-		/*LM_DBG("We are not pointing to an a=fmtp: attribute =>`%.*s'\n", body->len, body->s); */
+		/*LM_DBG("We are not pointing to an a=fmtp: attribute =>`%.*s'\n",
+		 * body->len, body->s); */
 		return -1;
 	}
 
-- 
2.17.1

