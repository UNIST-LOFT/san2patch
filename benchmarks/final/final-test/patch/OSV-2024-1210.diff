From d4bbde619bbf808edebb31e131b3783ba2a4b34d Mon Sep 17 00:00:00 2001
From: Daniel-Constantin Mierla <miconda@gmail.com>
Date: Fri, 11 Oct 2024 12:00:53 +0200
Subject: [PATCH] core: parse sdp - check for body limit on mixed content

---
 src/core/parser/sdp/sdp.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/src/core/parser/sdp/sdp.c b/src/core/parser/sdp/sdp.c
index 52e967a3db..06fc411f50 100644
--- a/src/core/parser/sdp/sdp.c
+++ b/src/core/parser/sdp/sdp.c
@@ -810,9 +810,11 @@ static int parse_mixed_content(str *mixed_body, str delimiter, sdp_info_t *_sdp)
 		} /* end of while */
 		/* and now we need to parse the content */
 		if(start_parsing) {
-			while(('\n' == *rest) || ('\r' == *rest) || ('\t' == *rest)
-					|| (' ' == *rest))
+			while((rest < bodylimit)
+					&& (('\n' == *rest) || ('\r' == *rest) || ('\t' == *rest)
+							|| (' ' == *rest))) {
 				rest++; /* Skip any whitespace */
+			}
 			_sdp->raw_sdp.s = rest;
 			_sdp->raw_sdp.len = d2p - rest;
 			/* LM_DBG("we need to check session %d: <%.*s>\n", session_num, _sdp.raw_sdp.len, _sdp.raw_sdp.s); */
-- 
2.17.1

