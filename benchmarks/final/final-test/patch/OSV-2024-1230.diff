From c823f41350ab9186a323707e9be32e31922bec17 Mon Sep 17 00:00:00 2001
From: Daniel-Constantin Mierla <miconda@gmail.com>
Date: Tue, 22 Oct 2024 07:41:08 +0200
Subject: [PATCH] core: parser sdp - check length for rtpmap extract

---
 src/core/parser/sdp/sdp_helpr_funcs.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/src/core/parser/sdp/sdp_helpr_funcs.c b/src/core/parser/sdp/sdp_helpr_funcs.c
index a74f78abb8..fe5b464e47 100644
--- a/src/core/parser/sdp/sdp_helpr_funcs.c
+++ b/src/core/parser/sdp/sdp_helpr_funcs.c
@@ -151,6 +151,9 @@ int extract_rtpmap(str *body, str *rtpmap_payload, str *rtpmap_encoding,
 	char *cp, *cp1;
 	int len;
 
+	if(body->len <= 9) {
+		return -1;
+	}
 	if(strncasecmp(body->s, "a=rtpmap:", 9) != 0) {
 		/*LM_DBG("We are not pointing to an a=rtpmap: attribute =>`%.*s'\n",
 		 * body->len, body->s); */
-- 
2.17.1

